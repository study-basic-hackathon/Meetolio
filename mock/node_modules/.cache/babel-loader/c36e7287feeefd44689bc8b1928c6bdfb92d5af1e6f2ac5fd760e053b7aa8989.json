{"ast":null,"code":"import _objectSpread from\"/Users/takahiro/Dev/webhack/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useState,useEffect,useRef}from\"react\";import{useNavigate}from\"react-router-dom\";import{useAuth}from\"../contexts/AuthContext\";import{Stage,Layer,Rect,Text,Transformer,Circle,Line,Group}from\"react-konva\";import\"./BusinessCardDesign.css\";import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const BusinessCardDesign=()=>{const{user,isAuthenticated}=useAuth();const navigate=useNavigate();const[profile,setProfile]=useState(null);const[isLoading,setIsLoading]=useState(true);const[currentSide,setCurrentSide]=useState(\"front\");const[elements,setElements]=useState([]);const[selectedId,setSelectedId]=useState(null);const[editingText,setEditingText]=useState(\"\");const[fontSize,setFontSize]=useState(16);const[textColor,setTextColor]=useState(\"#000000\");const[fontFamily,setFontFamily]=useState(\"Arial\");const[currentTool,setCurrentTool]=useState(\"select\");const[showGrid,setShowGrid]=useState(false);const[showGuidelines,setShowGuidelines]=useState(true);const[history,setHistory]=useState([]);const[historyIndex,setHistoryIndex]=useState(-1);const[showTextModal,setShowTextModal]=useState(false);const[selectedTextStyle,setSelectedTextStyle]=useState(\"body\");const[contextMenu,setContextMenu]=useState({visible:false,x:0,y:0,elementId:\"\"});const transformerRef=useRef(null);const stageRef=useRef(null);useEffect(()=>{if(!isAuthenticated){navigate(\"/login\");return;}// モックプロフィールデータを取得\nconst mockProfile={id:\"1\",userId:(user===null||user===void 0?void 0:user.id)||\"1\",company:\"テック株式会社\",jobTitle:\"フロントエンドエンジニア\",bio:\"Web開発に携わって5年目です。React、TypeScript、Node.jsを中心に開発を行っています。ユーザビリティを重視した設計を心がけています。\",skills:[\"React\",\"TypeScript\",\"Node.js\",\"CSS\",\"HTML\",\"JavaScript\",\"Git\",\"AWS\"],interests:[\"プログラミング\",\"読書\",\"旅行\",\"料理\",\"音楽\"],contactInfo:{email:\"taro.tech@example.com\",phone:\"090-1234-5678\",sns:{twitter:\"taro_tech\",linkedin:\"taro-tech\",github:\"taro-tech\",instagram:\"taro_tech_dev\"},website:\"https://taro-tech.dev\"},isPublic:true,createdAt:new Date(\"2024-01-01\"),updatedAt:new Date()};setProfile(mockProfile);setIsLoading(false);},[isAuthenticated,user,navigate]);// 初期テキスト要素を設定\nuseEffect(()=>{if(profile){const initialElements=currentSide===\"front\"?[{id:\"company\",type:\"text\",text:profile.company||\"会社名\",x:200,y:60,fontSize:18,fontFamily:\"Arial\",fill:\"#000000\",width:400,align:\"center\",draggable:true,textStyle:\"heading\"},{id:\"jobTitle\",type:\"text\",text:profile.jobTitle||\"役職\",x:200,y:90,fontSize:14,fontFamily:\"Arial\",fill:\"#666666\",width:400,align:\"center\",draggable:true,textStyle:\"subheading\"},{id:\"name\",type:\"text\",text:(user===null||user===void 0?void 0:user.name)||\"氏名\",x:200,y:120,fontSize:16,fontFamily:\"Arial\",fill:\"#000000\",width:400,align:\"center\",draggable:true,textStyle:\"body\"}]:[{id:\"email\",type:\"text\",text:profile.contactInfo.email||\"メールアドレス\",x:200,y:80,fontSize:12,fontFamily:\"Arial\",fill:\"#000000\",width:400,align:\"center\",draggable:true,textStyle:\"body\"},{id:\"phone\",type:\"text\",text:profile.contactInfo.phone||\"電話番号\",x:200,y:110,fontSize:12,fontFamily:\"Arial\",fill:\"#000000\",width:400,align:\"center\",draggable:true,textStyle:\"body\"},{id:\"website\",type:\"text\",text:profile.contactInfo.website||\"ウェブサイト\",x:200,y:140,fontSize:12,fontFamily:\"Arial\",fill:\"#000000\",width:400,align:\"center\",draggable:true,textStyle:\"body\"}];setElements(initialElements);// eslint-disable-next-line react-hooks/exhaustive-deps\naddToHistory(initialElements);}},[profile,currentSide,user]);// 選択された要素のTransformerを更新\nuseEffect(()=>{if(selectedId&&transformerRef.current){var _stageRef$current;const node=(_stageRef$current=stageRef.current)===null||_stageRef$current===void 0?void 0:_stageRef$current.findOne(\"#\".concat(selectedId));if(node){var _transformerRef$curre;transformerRef.current.nodes([node]);(_transformerRef$curre=transformerRef.current.getLayer())===null||_transformerRef$curre===void 0?void 0:_transformerRef$curre.batchDraw();}}},[selectedId]);// 履歴管理\nconst addToHistory=newElements=>{const newHistory=history.slice(0,historyIndex+1);newHistory.push([...newElements]);setHistory(newHistory);setHistoryIndex(newHistory.length-1);};const undo=()=>{if(historyIndex>0){const newIndex=historyIndex-1;setHistoryIndex(newIndex);setElements([...history[newIndex]]);}};const redo=()=>{if(historyIndex<history.length-1){const newIndex=historyIndex+1;setHistoryIndex(newIndex);setElements([...history[newIndex]]);}};const moveElement=(id,direction)=>{const newElements=[...elements];const currentIndex=newElements.findIndex(el=>el.id===id);if(direction===\"forward\"&&currentIndex<newElements.length-1){[newElements[currentIndex],newElements[currentIndex+1]]=[newElements[currentIndex+1],newElements[currentIndex]];}else if(direction===\"backward\"&&currentIndex>0){[newElements[currentIndex],newElements[currentIndex-1]]=[newElements[currentIndex-1],newElements[currentIndex]];}setElements(newElements);addToHistory(newElements);};const alignElements=alignment=>{if(selectedId){const selectedElement=elements.find(el=>el.id===selectedId);if(!selectedElement)return;const newElements=elements.map(el=>{if(el.id===selectedId){const newEl=_objectSpread({},el);switch(alignment){case\"left\":newEl.x=50;break;case\"center\":newEl.x=200;break;case\"right\":newEl.x=350;break;case\"top\":newEl.y=50;break;case\"middle\":newEl.y=121;break;case\"bottom\":newEl.y=192;break;}return newEl;}return el;});setElements(newElements);addToHistory(newElements);}};const handleTextClick=(id,event)=>{setSelectedId(id);// コンテキストメニューの位置を計算\nconst stage=event.target.getStage();const pointerPosition=stage.getPointerPosition();setContextMenu({visible:true,x:pointerPosition.x,y:pointerPosition.y,// 要素のすぐ上に表示\nelementId:id});};const handleTextEdit=(id,newText)=>{const newElements=elements.map(el=>el.id===id&&el.type===\"text\"?_objectSpread(_objectSpread({},el),{},{text:newText}):el);setElements(newElements);addToHistory(newElements);setEditingText(\"\");};const handleElementUpdate=(id,updates)=>{const newElements=elements.map(el=>el.id===id?_objectSpread(_objectSpread({},el),updates):el);setElements(newElements);addToHistory(newElements);};const handleAddText=function(){let style=arguments.length>0&&arguments[0]!==undefined?arguments[0]:\"body\";let fontSize=16;let y=100;switch(style){case\"heading\":fontSize=24;y=80;break;case\"subheading\":fontSize=18;y=110;break;case\"body\":fontSize=14;y=140;break;}const newText={id:\"text-\".concat(Date.now()),type:\"text\",text:style===\"heading\"?\"見出し\":style===\"subheading\"?\"小見出し\":\"本文\",x:200,y:y,fontSize:fontSize,fontFamily:fontFamily,fill:textColor,width:400,align:\"center\",draggable:true,textStyle:style};const newElements=[...elements,newText];setElements(newElements);addToHistory(newElements);setSelectedId(newText.id);setShowTextModal(true);};const handleAddShape=shapeType=>{let newShape;switch(shapeType){case\"rect\":newShape={id:\"rect-\".concat(Date.now()),type:\"rect\",x:100,y:100,width:100,height:60,fill:textColor,stroke:\"#000000\",strokeWidth:2,draggable:true};break;case\"circle\":newShape={id:\"circle-\".concat(Date.now()),type:\"circle\",x:150,y:150,radius:30,fill:textColor,stroke:\"#000000\",strokeWidth:2,draggable:true};break;case\"line\":newShape={id:\"line-\".concat(Date.now()),type:\"line\",x:100,y:100,points:[0,0,100,0],fill:\"#000000\",stroke:\"#000000\",strokeWidth:2,draggable:true};break;}const newElements=[...elements,newShape];setElements(newElements);addToHistory(newElements);setSelectedId(newShape.id);};const handleAddIcon=iconType=>{const newIcon={id:\"icon-\".concat(Date.now()),type:\"icon\",iconType,x:100,y:100,size:24,fill:textColor,draggable:true};const newElements=[...elements,newIcon];setElements(newElements);addToHistory(newElements);setSelectedId(newIcon.id);};const handleDeleteElement=()=>{if(selectedId){const newElements=elements.filter(el=>el.id!==selectedId);setElements(newElements);addToHistory(newElements);setSelectedId(null);}};const handleSave=async()=>{try{await new Promise(resolve=>setTimeout(resolve,1000));console.log(\"名刺デザインを保存しました\");console.log(\"現在の要素:\",elements);navigate(\"/business-card/edit\");}catch(error){console.error(\"名刺デザインの保存に失敗しました:\",error);}};const handleCancel=()=>{navigate(\"/business-card/edit\");};const handleExportImage=()=>{if(stageRef.current){const dataURL=stageRef.current.toDataURL();const link=document.createElement(\"a\");link.download=\"business-card-\".concat(currentSide,\".png\");link.href=dataURL;link.click();}};const renderElement=element=>{switch(element.type){case\"text\":return/*#__PURE__*/_jsx(Text,{id:element.id,text:element.text,x:element.x,y:element.y,fontSize:element.fontSize,fontFamily:element.fontFamily,fill:element.fill,align:element.align,width:element.width,draggable:element.draggable,onClick:e=>handleTextClick(element.id,e),onTap:e=>handleTextClick(element.id,e),onDragEnd:e=>{handleElementUpdate(element.id,{x:e.target.x(),y:e.target.y()});}},element.id);case\"rect\":return/*#__PURE__*/_jsx(Rect,{id:element.id,x:element.x,y:element.y,width:element.width,height:element.height,fill:element.fill,stroke:element.stroke,strokeWidth:element.strokeWidth,draggable:element.draggable,onClick:()=>setSelectedId(element.id),onTap:()=>setSelectedId(element.id),onDragEnd:e=>{handleElementUpdate(element.id,{x:e.target.x(),y:e.target.y()});}},element.id);case\"circle\":return/*#__PURE__*/_jsx(Circle,{id:element.id,x:element.x,y:element.y,radius:element.radius,fill:element.fill,stroke:element.stroke,strokeWidth:element.strokeWidth,draggable:element.draggable,onClick:()=>setSelectedId(element.id),onTap:()=>setSelectedId(element.id),onDragEnd:e=>{handleElementUpdate(element.id,{x:e.target.x(),y:e.target.y()});}},element.id);case\"line\":return/*#__PURE__*/_jsx(Line,{id:element.id,x:element.x,y:element.y,points:element.points,fill:element.fill,stroke:element.stroke,strokeWidth:element.strokeWidth,draggable:element.draggable,onClick:()=>setSelectedId(element.id),onTap:()=>setSelectedId(element.id),onDragEnd:e=>{handleElementUpdate(element.id,{x:e.target.x(),y:e.target.y()});}},element.id);case\"icon\":return/*#__PURE__*/_jsxs(Group,{id:element.id,x:element.x,y:element.y,draggable:element.draggable,onClick:()=>setSelectedId(element.id),onTap:()=>setSelectedId(element.id),onDragEnd:e=>{handleElementUpdate(element.id,{x:e.target.x(),y:e.target.y()});},children:[element.iconType===\"phone\"&&/*#__PURE__*/_jsx(Rect,{x:0,y:0,width:element.size,height:element.size*1.6,fill:element.fill}),element.iconType===\"email\"&&/*#__PURE__*/_jsx(Rect,{x:0,y:0,width:element.size,height:element.size*0.8,fill:element.fill}),element.iconType===\"website\"&&/*#__PURE__*/_jsx(Circle,{x:element.size/2,y:element.size/2,radius:element.size/2,fill:element.fill})]},element.id);default:return null;}};if(isLoading){return/*#__PURE__*/_jsx(\"div\",{className:\"business-card-design\",children:/*#__PURE__*/_jsx(\"div\",{className:\"container\",children:/*#__PURE__*/_jsx(\"div\",{className:\"loading\",children:\"\\u8AAD\\u307F\\u8FBC\\u307F\\u4E2D...\"})})});}if(!profile){return/*#__PURE__*/_jsx(\"div\",{className:\"business-card-design\",children:/*#__PURE__*/_jsx(\"div\",{className:\"container\",children:/*#__PURE__*/_jsx(\"div\",{className:\"error\",children:\"\\u30D7\\u30ED\\u30D5\\u30A3\\u30FC\\u30EB\\u304C\\u898B\\u3064\\u304B\\u308A\\u307E\\u305B\\u3093\"})})});}return/*#__PURE__*/_jsxs(\"div\",{className:\"business-card-design\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"container\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"design-header\",children:[/*#__PURE__*/_jsx(\"h1\",{children:\"\\u540D\\u523A\\u30C7\\u30B6\\u30A4\\u30F3\"}),/*#__PURE__*/_jsx(\"p\",{children:\"\\u540D\\u523A\\u306E\\u8868\\u9762\\u30FB\\u88CF\\u9762\\u3092\\u30C7\\u30B6\\u30A4\\u30F3\\u3067\\u304D\\u307E\\u3059\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"design-container\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"side-tabs\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"side-tab \".concat(currentSide===\"front\"?\"active\":\"\"),onClick:()=>setCurrentSide(\"front\"),children:\"\\u8868\\u9762\"}),/*#__PURE__*/_jsx(\"button\",{className:\"side-tab \".concat(currentSide===\"back\"?\"active\":\"\"),onClick:()=>setCurrentSide(\"back\"),children:\"\\u88CF\\u9762\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"canvas-container\",children:/*#__PURE__*/_jsx(\"div\",{className:\"canvas-wrapper\",children:/*#__PURE__*/_jsx(Stage,{ref:stageRef,width:400,height:242,onMouseDown:e=>{if(e.target===e.target.getStage()){setSelectedId(null);setContextMenu(_objectSpread(_objectSpread({},contextMenu),{},{visible:false}));}},children:/*#__PURE__*/_jsxs(Layer,{children:[/*#__PURE__*/_jsx(Rect,{x:0,y:0,width:400,height:242,fill:\"#ffffff\",stroke:\"#e5e7eb\",strokeWidth:1}),showGrid&&/*#__PURE__*/_jsxs(_Fragment,{children:[Array.from({length:20},(_,i)=>/*#__PURE__*/_jsx(Line,{x:i*20,y:0,points:[0,0,0,242],stroke:\"#f0f0f0\",strokeWidth:1},\"grid-v-\".concat(i))),Array.from({length:13},(_,i)=>/*#__PURE__*/_jsx(Line,{x:0,y:i*20,points:[0,0,400,0],stroke:\"#f0f0f0\",strokeWidth:1},\"grid-h-\".concat(i)))]}),showGuidelines&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(Line,{x:200,y:0,points:[0,0,0,242],stroke:\"#3b82f6\",strokeWidth:1,dash:[5,5]}),/*#__PURE__*/_jsx(Line,{x:0,y:121,points:[0,0,400,0],stroke:\"#3b82f6\",strokeWidth:1,dash:[5,5]})]}),elements.map(renderElement),/*#__PURE__*/_jsx(Transformer,{ref:transformerRef})]})})})}),/*#__PURE__*/_jsx(\"div\",{className:\"bottom-toolbar\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"toolbar-scroll\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"toolbar-item\",onClick:()=>setCurrentTool(\"select\"),children:[/*#__PURE__*/_jsx(\"div\",{className:\"toolbar-icon\",children:\"\\u270B\"}),/*#__PURE__*/_jsx(\"div\",{className:\"toolbar-label\",children:\"\\u9078\\u629E\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"toolbar-item\",onClick:()=>handleAddText(\"heading\"),children:[/*#__PURE__*/_jsx(\"div\",{className:\"toolbar-icon\",children:\"T\"}),/*#__PURE__*/_jsx(\"div\",{className:\"toolbar-label\",children:\"\\u30C6\\u30AD\\u30B9\\u30C8\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"toolbar-item\",onClick:()=>handleAddShape(\"rect\"),children:[/*#__PURE__*/_jsx(\"div\",{className:\"toolbar-icon\",children:\"\\u25A1\"}),/*#__PURE__*/_jsx(\"div\",{className:\"toolbar-label\",children:\"\\u56F3\\u5F62\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"toolbar-item\",onClick:()=>handleAddIcon(\"phone\"),children:[/*#__PURE__*/_jsx(\"div\",{className:\"toolbar-icon\",children:\"\\uD83D\\uDCDE\"}),/*#__PURE__*/_jsx(\"div\",{className:\"toolbar-label\",children:\"\\u30A2\\u30A4\\u30B3\\u30F3\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"toolbar-item \".concat(historyIndex<=0?\"disabled\":\"\"),onClick:historyIndex>0?undo:undefined,children:[/*#__PURE__*/_jsx(\"div\",{className:\"toolbar-icon\",children:\"\\u21B6\"}),/*#__PURE__*/_jsx(\"div\",{className:\"toolbar-label\",children:\"\\u623B\\u308B\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"toolbar-item \".concat(historyIndex>=history.length-1?\"disabled\":\"\"),onClick:historyIndex<history.length-1?redo:undefined,children:[/*#__PURE__*/_jsx(\"div\",{className:\"toolbar-icon\",children:\"\\u21B7\"}),/*#__PURE__*/_jsx(\"div\",{className:\"toolbar-label\",children:\"\\u9032\\u3080\"})]})]})}),/*#__PURE__*/_jsxs(\"div\",{className:\"design-actions\",children:[/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"btn btn-secondary\",onClick:handleCancel,children:\"\\u30AD\\u30E3\\u30F3\\u30BB\\u30EB\"}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"btn btn-primary\",onClick:handleSave,children:\"\\u30C7\\u30B6\\u30A4\\u30F3\\u3092\\u4FDD\\u5B58\"})]})]})]}),showTextModal&&/*#__PURE__*/_jsx(\"div\",{className:\"modal-overlay\",onClick:()=>setShowTextModal(false),children:/*#__PURE__*/_jsxs(\"div\",{className:\"modal-content\",onClick:e=>e.stopPropagation(),children:[/*#__PURE__*/_jsxs(\"div\",{className:\"modal-header\",children:[/*#__PURE__*/_jsx(\"h3\",{children:\"\\u30C6\\u30AD\\u30B9\\u30C8\\u7DE8\\u96C6\"}),/*#__PURE__*/_jsx(\"button\",{className:\"modal-close\",onClick:()=>setShowTextModal(false),children:\"\\xD7\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"modal-body\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"search-section\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"search-bar\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"search-icon\",children:\"\\uD83D\\uDD0D\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"\\u30D5\\u30A9\\u30F3\\u30C8\\u3068\\u7D44\\u307F\\u5408\\u308F\\u305B\\u3092\\u691C\\u7D22\",className:\"search-input\"})]})}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-options\",children:[/*#__PURE__*/_jsxs(\"button\",{className:\"text-option-btn primary\",onClick:()=>handleAddText(\"heading\"),children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-icon\",children:\"T\"}),/*#__PURE__*/_jsx(\"span\",{className:\"text-label\",children:\"\\u898B\\u51FA\\u3057\\u3092\\u8FFD\\u52A0\"})]}),/*#__PURE__*/_jsxs(\"button\",{className:\"text-option-btn secondary\",onClick:()=>handleAddText(\"subheading\"),children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-icon\",children:\"T\"}),/*#__PURE__*/_jsx(\"span\",{className:\"text-label\",children:\"\\u5C0F\\u898B\\u51FA\\u3057\\u3092\\u8FFD\\u52A0\"})]}),/*#__PURE__*/_jsxs(\"button\",{className:\"text-option-btn secondary\",onClick:()=>handleAddText(\"body\"),children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-icon\",children:\"T\"}),/*#__PURE__*/_jsx(\"span\",{className:\"text-label\",children:\"\\u672C\\u6587\\u3092\\u8FFD\\u52A0\"})]})]}),selectedId&&/*#__PURE__*/_jsxs(\"div\",{className:\"text-editor-section\",children:[/*#__PURE__*/_jsx(\"h4\",{children:\"\\u30C6\\u30AD\\u30B9\\u30C8\\u7DE8\\u96C6\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:editingText,onChange:e=>setEditingText(e.target.value),onBlur:()=>handleTextEdit(selectedId,editingText),onKeyPress:e=>{if(e.key===\"Enter\"){handleTextEdit(selectedId,editingText);}},placeholder:\"\\u30C6\\u30AD\\u30B9\\u30C8\\u3092\\u5165\\u529B\",className:\"text-input\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"style-controls\",children:[/*#__PURE__*/_jsxs(\"label\",{children:[\"\\u30D5\\u30A9\\u30F3\\u30C8\\u30B5\\u30A4\\u30BA:\",/*#__PURE__*/_jsx(\"input\",{type:\"range\",min:\"8\",max:\"48\",value:fontSize,onChange:e=>{setFontSize(Number(e.target.value));if(selectedId){const element=elements.find(el=>el.id===selectedId);if(element&&element.type===\"text\"){handleElementUpdate(selectedId,{fontSize:Number(e.target.value)});}}},className:\"font-size-slider\"}),/*#__PURE__*/_jsxs(\"span\",{children:[fontSize,\"px\"]})]}),/*#__PURE__*/_jsxs(\"label\",{children:[\"\\u30D5\\u30A9\\u30F3\\u30C8:\",/*#__PURE__*/_jsxs(\"select\",{value:fontFamily,onChange:e=>{setFontFamily(e.target.value);if(selectedId){const element=elements.find(el=>el.id===selectedId);if(element&&element.type===\"text\"){handleElementUpdate(selectedId,{fontFamily:e.target.value});}}},className:\"font-family-select\",children:[/*#__PURE__*/_jsx(\"option\",{value:\"Arial\",children:\"Arial\"}),/*#__PURE__*/_jsx(\"option\",{value:\"Helvetica\",children:\"Helvetica\"}),/*#__PURE__*/_jsx(\"option\",{value:\"Times New Roman\",children:\"Times New Roman\"}),/*#__PURE__*/_jsx(\"option\",{value:\"Georgia\",children:\"Georgia\"}),/*#__PURE__*/_jsx(\"option\",{value:\"Verdana\",children:\"Verdana\"})]})]}),/*#__PURE__*/_jsxs(\"label\",{children:[\"\\u8272:\",/*#__PURE__*/_jsx(\"input\",{type:\"color\",value:textColor,onChange:e=>{setTextColor(e.target.value);if(selectedId){handleElementUpdate(selectedId,{fill:e.target.value});}},className:\"color-picker\"})]})]})]})]})]})}),contextMenu.visible&&/*#__PURE__*/_jsxs(\"div\",{className:\"context-menu\",style:{position:\"absolute\",left:contextMenu.x,top:contextMenu.y,zIndex:1000},children:[/*#__PURE__*/_jsx(\"button\",{className:\"context-menu-btn edit-btn\",onClick:()=>{const element=elements.find(el=>el.id===contextMenu.elementId);if(element&&element.type===\"text\"){setEditingText(element.text);setSelectedTextStyle(element.textStyle||\"body\");setShowTextModal(true);}setContextMenu(_objectSpread(_objectSpread({},contextMenu),{},{visible:false}));},children:\"\\u270F\\uFE0F\"}),/*#__PURE__*/_jsx(\"button\",{className:\"context-menu-btn delete-btn\",onClick:()=>{const newElements=elements.filter(el=>el.id!==contextMenu.elementId);setElements(newElements);addToHistory(newElements);setSelectedId(null);setContextMenu(_objectSpread(_objectSpread({},contextMenu),{},{visible:false}));},children:\"\\u22EF\"})]})]});};export default BusinessCardDesign;","map":{"version":3,"names":["React","useState","useEffect","useRef","useNavigate","useAuth","Stage","Layer","Rect","Text","Transformer","Circle","Line","Group","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","BusinessCardDesign","user","isAuthenticated","navigate","profile","setProfile","isLoading","setIsLoading","currentSide","setCurrentSide","elements","setElements","selectedId","setSelectedId","editingText","setEditingText","fontSize","setFontSize","textColor","setTextColor","fontFamily","setFontFamily","currentTool","setCurrentTool","showGrid","setShowGrid","showGuidelines","setShowGuidelines","history","setHistory","historyIndex","setHistoryIndex","showTextModal","setShowTextModal","selectedTextStyle","setSelectedTextStyle","contextMenu","setContextMenu","visible","x","y","elementId","transformerRef","stageRef","mockProfile","id","userId","company","jobTitle","bio","skills","interests","contactInfo","email","phone","sns","twitter","linkedin","github","instagram","website","isPublic","createdAt","Date","updatedAt","initialElements","type","text","fill","width","align","draggable","textStyle","name","addToHistory","current","_stageRef$current","node","findOne","concat","_transformerRef$curre","nodes","getLayer","batchDraw","newElements","newHistory","slice","push","length","undo","newIndex","redo","moveElement","direction","currentIndex","findIndex","el","alignElements","alignment","selectedElement","find","map","newEl","_objectSpread","handleTextClick","event","stage","target","getStage","pointerPosition","getPointerPosition","handleTextEdit","newText","handleElementUpdate","updates","handleAddText","style","arguments","undefined","now","handleAddShape","shapeType","newShape","height","stroke","strokeWidth","radius","points","handleAddIcon","iconType","newIcon","size","handleDeleteElement","filter","handleSave","Promise","resolve","setTimeout","console","log","error","handleCancel","handleExportImage","dataURL","toDataURL","link","document","createElement","download","href","click","renderElement","element","onClick","e","onTap","onDragEnd","children","className","ref","onMouseDown","Array","from","_","i","dash","stopPropagation","placeholder","value","onChange","onBlur","onKeyPress","key","min","max","Number","position","left","top","zIndex"],"sources":["/Users/takahiro/Dev/webhack/src/pages/BusinessCardDesign.tsx"],"sourcesContent":["import React, { useState, useEffect, useRef } from \"react\";\nimport { useNavigate } from \"react-router-dom\";\nimport { useAuth } from \"../contexts/AuthContext\";\nimport { Profile } from \"../types\";\nimport {\n  Stage,\n  Layer,\n  Rect,\n  Text,\n  Transformer,\n  Circle,\n  Line,\n  Group,\n} from \"react-konva\";\nimport Konva from \"konva\";\nimport \"./BusinessCardDesign.css\";\n\ninterface TextElement {\n  id: string;\n  type: \"text\";\n  text: string;\n  x: number;\n  y: number;\n  fontSize: number;\n  fontFamily: string;\n  fill: string;\n  width: number;\n  align: string;\n  draggable: boolean;\n  textStyle?: \"heading\" | \"subheading\" | \"body\";\n}\n\ninterface ShapeElement {\n  id: string;\n  type: \"rect\" | \"circle\" | \"line\";\n  x: number;\n  y: number;\n  width?: number;\n  height?: number;\n  radius?: number;\n  points?: number[];\n  fill: string;\n  stroke: string;\n  strokeWidth: number;\n  draggable: boolean;\n}\n\ninterface IconElement {\n  id: string;\n  type: \"icon\";\n  iconType: string;\n  x: number;\n  y: number;\n  size: number;\n  fill: string;\n  draggable: boolean;\n}\n\ntype DesignElement = TextElement | ShapeElement | IconElement;\n\nconst BusinessCardDesign: React.FC = () => {\n  const { user, isAuthenticated } = useAuth();\n  const navigate = useNavigate();\n  const [profile, setProfile] = useState<Profile | null>(null);\n  const [isLoading, setIsLoading] = useState(true);\n  const [currentSide, setCurrentSide] = useState<\"front\" | \"back\">(\"front\");\n  const [elements, setElements] = useState<DesignElement[]>([]);\n  const [selectedId, setSelectedId] = useState<string | null>(null);\n  const [editingText, setEditingText] = useState<string>(\"\");\n  const [fontSize, setFontSize] = useState(16);\n  const [textColor, setTextColor] = useState(\"#000000\");\n  const [fontFamily, setFontFamily] = useState(\"Arial\");\n  const [currentTool, setCurrentTool] = useState<\n    \"select\" | \"text\" | \"rect\" | \"circle\" | \"line\" | \"icon\"\n  >(\"select\");\n  const [showGrid, setShowGrid] = useState(false);\n  const [showGuidelines, setShowGuidelines] = useState(true);\n  const [history, setHistory] = useState<DesignElement[][]>([]);\n  const [historyIndex, setHistoryIndex] = useState(-1);\n  const [showTextModal, setShowTextModal] = useState(false);\n  const [selectedTextStyle, setSelectedTextStyle] = useState<\n    \"heading\" | \"subheading\" | \"body\"\n  >(\"body\");\n  const [contextMenu, setContextMenu] = useState<{\n    visible: boolean;\n    x: number;\n    y: number;\n    elementId: string;\n  }>({\n    visible: false,\n    x: 0,\n    y: 0,\n    elementId: \"\",\n  });\n\n  const transformerRef = useRef<Konva.Transformer>(null);\n  const stageRef = useRef<Konva.Stage>(null);\n\n  useEffect(() => {\n    if (!isAuthenticated) {\n      navigate(\"/login\");\n      return;\n    }\n\n    // モックプロフィールデータを取得\n    const mockProfile: Profile = {\n      id: \"1\",\n      userId: user?.id || \"1\",\n      company: \"テック株式会社\",\n      jobTitle: \"フロントエンドエンジニア\",\n      bio: \"Web開発に携わって5年目です。React、TypeScript、Node.jsを中心に開発を行っています。ユーザビリティを重視した設計を心がけています。\",\n      skills: [\n        \"React\",\n        \"TypeScript\",\n        \"Node.js\",\n        \"CSS\",\n        \"HTML\",\n        \"JavaScript\",\n        \"Git\",\n        \"AWS\",\n      ],\n      interests: [\"プログラミング\", \"読書\", \"旅行\", \"料理\", \"音楽\"],\n      contactInfo: {\n        email: \"taro.tech@example.com\",\n        phone: \"090-1234-5678\",\n        sns: {\n          twitter: \"taro_tech\",\n          linkedin: \"taro-tech\",\n          github: \"taro-tech\",\n          instagram: \"taro_tech_dev\",\n        },\n        website: \"https://taro-tech.dev\",\n      },\n      isPublic: true,\n      createdAt: new Date(\"2024-01-01\"),\n      updatedAt: new Date(),\n    };\n\n    setProfile(mockProfile);\n    setIsLoading(false);\n  }, [isAuthenticated, user, navigate]);\n\n  // 初期テキスト要素を設定\n  useEffect(() => {\n    if (profile) {\n      const initialElements: DesignElement[] =\n        currentSide === \"front\"\n          ? [\n              {\n                id: \"company\",\n                type: \"text\",\n                text: profile.company || \"会社名\",\n                x: 200,\n                y: 60,\n                fontSize: 18,\n                fontFamily: \"Arial\",\n                fill: \"#000000\",\n                width: 400,\n                align: \"center\",\n                draggable: true,\n                textStyle: \"heading\",\n              },\n              {\n                id: \"jobTitle\",\n                type: \"text\",\n                text: profile.jobTitle || \"役職\",\n                x: 200,\n                y: 90,\n                fontSize: 14,\n                fontFamily: \"Arial\",\n                fill: \"#666666\",\n                width: 400,\n                align: \"center\",\n                draggable: true,\n                textStyle: \"subheading\",\n              },\n              {\n                id: \"name\",\n                type: \"text\",\n                text: user?.name || \"氏名\",\n                x: 200,\n                y: 120,\n                fontSize: 16,\n                fontFamily: \"Arial\",\n                fill: \"#000000\",\n                width: 400,\n                align: \"center\",\n                draggable: true,\n                textStyle: \"body\",\n              },\n            ]\n          : [\n              {\n                id: \"email\",\n                type: \"text\",\n                text: profile.contactInfo.email || \"メールアドレス\",\n                x: 200,\n                y: 80,\n                fontSize: 12,\n                fontFamily: \"Arial\",\n                fill: \"#000000\",\n                width: 400,\n                align: \"center\",\n                draggable: true,\n                textStyle: \"body\",\n              },\n              {\n                id: \"phone\",\n                type: \"text\",\n                text: profile.contactInfo.phone || \"電話番号\",\n                x: 200,\n                y: 110,\n                fontSize: 12,\n                fontFamily: \"Arial\",\n                fill: \"#000000\",\n                width: 400,\n                align: \"center\",\n                draggable: true,\n                textStyle: \"body\",\n              },\n              {\n                id: \"website\",\n                type: \"text\",\n                text: profile.contactInfo.website || \"ウェブサイト\",\n                x: 200,\n                y: 140,\n                fontSize: 12,\n                fontFamily: \"Arial\",\n                fill: \"#000000\",\n                width: 400,\n                align: \"center\",\n                draggable: true,\n                textStyle: \"body\",\n              },\n            ];\n\n      setElements(initialElements);\n      // eslint-disable-next-line react-hooks/exhaustive-deps\n      addToHistory(initialElements);\n    }\n  }, [profile, currentSide, user]);\n\n  // 選択された要素のTransformerを更新\n  useEffect(() => {\n    if (selectedId && transformerRef.current) {\n      const node = stageRef.current?.findOne(`#${selectedId}`);\n      if (node) {\n        transformerRef.current.nodes([node]);\n        transformerRef.current.getLayer()?.batchDraw();\n      }\n    }\n  }, [selectedId]);\n\n  // 履歴管理\n  const addToHistory = (newElements: DesignElement[]) => {\n    const newHistory = history.slice(0, historyIndex + 1);\n    newHistory.push([...newElements]);\n    setHistory(newHistory);\n    setHistoryIndex(newHistory.length - 1);\n  };\n\n  const undo = () => {\n    if (historyIndex > 0) {\n      const newIndex = historyIndex - 1;\n      setHistoryIndex(newIndex);\n      setElements([...history[newIndex]]);\n    }\n  };\n\n  const redo = () => {\n    if (historyIndex < history.length - 1) {\n      const newIndex = historyIndex + 1;\n      setHistoryIndex(newIndex);\n      setElements([...history[newIndex]]);\n    }\n  };\n\n  const moveElement = (id: string, direction: \"forward\" | \"backward\") => {\n    const newElements = [...elements];\n    const currentIndex = newElements.findIndex((el) => el.id === id);\n\n    if (direction === \"forward\" && currentIndex < newElements.length - 1) {\n      [newElements[currentIndex], newElements[currentIndex + 1]] = [\n        newElements[currentIndex + 1],\n        newElements[currentIndex],\n      ];\n    } else if (direction === \"backward\" && currentIndex > 0) {\n      [newElements[currentIndex], newElements[currentIndex - 1]] = [\n        newElements[currentIndex - 1],\n        newElements[currentIndex],\n      ];\n    }\n\n    setElements(newElements);\n    addToHistory(newElements);\n  };\n\n  const alignElements = (\n    alignment: \"left\" | \"center\" | \"right\" | \"top\" | \"middle\" | \"bottom\"\n  ) => {\n    if (selectedId) {\n      const selectedElement = elements.find((el) => el.id === selectedId);\n      if (!selectedElement) return;\n\n      const newElements = elements.map((el) => {\n        if (el.id === selectedId) {\n          const newEl = { ...el };\n          switch (alignment) {\n            case \"left\":\n              newEl.x = 50;\n              break;\n            case \"center\":\n              newEl.x = 200;\n              break;\n            case \"right\":\n              newEl.x = 350;\n              break;\n            case \"top\":\n              newEl.y = 50;\n              break;\n            case \"middle\":\n              newEl.y = 121;\n              break;\n            case \"bottom\":\n              newEl.y = 192;\n              break;\n          }\n          return newEl;\n        }\n        return el;\n      });\n\n      setElements(newElements);\n      addToHistory(newElements);\n    }\n  };\n\n  const handleTextClick = (id: string, event: any) => {\n    setSelectedId(id);\n\n    // コンテキストメニューの位置を計算\n    const stage = event.target.getStage();\n    const pointerPosition = stage.getPointerPosition();\n\n    setContextMenu({\n      visible: true,\n      x: pointerPosition.x,\n      y: pointerPosition.y, // 要素のすぐ上に表示\n      elementId: id,\n    });\n  };\n\n  const handleTextEdit = (id: string, newText: string) => {\n    const newElements = elements.map((el) =>\n      el.id === id && el.type === \"text\" ? { ...el, text: newText } : el\n    );\n    setElements(newElements);\n    addToHistory(newElements);\n    setEditingText(\"\");\n  };\n\n  const handleElementUpdate = (id: string, updates: any) => {\n    const newElements = elements.map((el) =>\n      el.id === id ? { ...el, ...updates } : el\n    );\n    setElements(newElements);\n    addToHistory(newElements);\n  };\n\n  const handleAddText = (style: \"heading\" | \"subheading\" | \"body\" = \"body\") => {\n    let fontSize = 16;\n    let y = 100;\n\n    switch (style) {\n      case \"heading\":\n        fontSize = 24;\n        y = 80;\n        break;\n      case \"subheading\":\n        fontSize = 18;\n        y = 110;\n        break;\n      case \"body\":\n        fontSize = 14;\n        y = 140;\n        break;\n    }\n\n    const newText: TextElement = {\n      id: `text-${Date.now()}`,\n      type: \"text\",\n      text:\n        style === \"heading\"\n          ? \"見出し\"\n          : style === \"subheading\"\n          ? \"小見出し\"\n          : \"本文\",\n      x: 200,\n      y: y,\n      fontSize: fontSize,\n      fontFamily: fontFamily,\n      fill: textColor,\n      width: 400,\n      align: \"center\",\n      draggable: true,\n      textStyle: style,\n    };\n    const newElements = [...elements, newText];\n    setElements(newElements);\n    addToHistory(newElements);\n    setSelectedId(newText.id);\n    setShowTextModal(true);\n  };\n\n  const handleAddShape = (shapeType: \"rect\" | \"circle\" | \"line\") => {\n    let newShape: ShapeElement;\n\n    switch (shapeType) {\n      case \"rect\":\n        newShape = {\n          id: `rect-${Date.now()}`,\n          type: \"rect\",\n          x: 100,\n          y: 100,\n          width: 100,\n          height: 60,\n          fill: textColor,\n          stroke: \"#000000\",\n          strokeWidth: 2,\n          draggable: true,\n        };\n        break;\n      case \"circle\":\n        newShape = {\n          id: `circle-${Date.now()}`,\n          type: \"circle\",\n          x: 150,\n          y: 150,\n          radius: 30,\n          fill: textColor,\n          stroke: \"#000000\",\n          strokeWidth: 2,\n          draggable: true,\n        };\n        break;\n      case \"line\":\n        newShape = {\n          id: `line-${Date.now()}`,\n          type: \"line\",\n          x: 100,\n          y: 100,\n          points: [0, 0, 100, 0],\n          fill: \"#000000\",\n          stroke: \"#000000\",\n          strokeWidth: 2,\n          draggable: true,\n        };\n        break;\n    }\n\n    const newElements = [...elements, newShape];\n    setElements(newElements);\n    addToHistory(newElements);\n    setSelectedId(newShape.id);\n  };\n\n  const handleAddIcon = (iconType: string) => {\n    const newIcon: IconElement = {\n      id: `icon-${Date.now()}`,\n      type: \"icon\",\n      iconType,\n      x: 100,\n      y: 100,\n      size: 24,\n      fill: textColor,\n      draggable: true,\n    };\n\n    const newElements = [...elements, newIcon];\n    setElements(newElements);\n    addToHistory(newElements);\n    setSelectedId(newIcon.id);\n  };\n\n  const handleDeleteElement = () => {\n    if (selectedId) {\n      const newElements = elements.filter((el) => el.id !== selectedId);\n      setElements(newElements);\n      addToHistory(newElements);\n      setSelectedId(null);\n    }\n  };\n\n  const handleSave = async () => {\n    try {\n      await new Promise((resolve) => setTimeout(resolve, 1000));\n      console.log(\"名刺デザインを保存しました\");\n      console.log(\"現在の要素:\", elements);\n      navigate(\"/business-card/edit\");\n    } catch (error) {\n      console.error(\"名刺デザインの保存に失敗しました:\", error);\n    }\n  };\n\n  const handleCancel = () => {\n    navigate(\"/business-card/edit\");\n  };\n\n  const handleExportImage = () => {\n    if (stageRef.current) {\n      const dataURL = stageRef.current.toDataURL();\n      const link = document.createElement(\"a\");\n      link.download = `business-card-${currentSide}.png`;\n      link.href = dataURL;\n      link.click();\n    }\n  };\n\n  const renderElement = (element: DesignElement) => {\n    switch (element.type) {\n      case \"text\":\n        return (\n          <Text\n            key={element.id}\n            id={element.id}\n            text={element.text}\n            x={element.x}\n            y={element.y}\n            fontSize={element.fontSize}\n            fontFamily={element.fontFamily}\n            fill={element.fill}\n            align={element.align as any}\n            width={element.width}\n            draggable={element.draggable}\n            onClick={(e) => handleTextClick(element.id, e)}\n            onTap={(e) => handleTextClick(element.id, e)}\n            onDragEnd={(e) => {\n              handleElementUpdate(element.id, {\n                x: e.target.x(),\n                y: e.target.y(),\n              });\n            }}\n          />\n        );\n      case \"rect\":\n        return (\n          <Rect\n            key={element.id}\n            id={element.id}\n            x={element.x}\n            y={element.y}\n            width={element.width}\n            height={element.height}\n            fill={element.fill}\n            stroke={element.stroke}\n            strokeWidth={element.strokeWidth}\n            draggable={element.draggable}\n            onClick={() => setSelectedId(element.id)}\n            onTap={() => setSelectedId(element.id)}\n            onDragEnd={(e) => {\n              handleElementUpdate(element.id, {\n                x: e.target.x(),\n                y: e.target.y(),\n              });\n            }}\n          />\n        );\n      case \"circle\":\n        return (\n          <Circle\n            key={element.id}\n            id={element.id}\n            x={element.x}\n            y={element.y}\n            radius={element.radius}\n            fill={element.fill}\n            stroke={element.stroke}\n            strokeWidth={element.strokeWidth}\n            draggable={element.draggable}\n            onClick={() => setSelectedId(element.id)}\n            onTap={() => setSelectedId(element.id)}\n            onDragEnd={(e) => {\n              handleElementUpdate(element.id, {\n                x: e.target.x(),\n                y: e.target.y(),\n              });\n            }}\n          />\n        );\n      case \"line\":\n        return (\n          <Line\n            key={element.id}\n            id={element.id}\n            x={element.x}\n            y={element.y}\n            points={element.points}\n            fill={element.fill}\n            stroke={element.stroke}\n            strokeWidth={element.strokeWidth}\n            draggable={element.draggable}\n            onClick={() => setSelectedId(element.id)}\n            onTap={() => setSelectedId(element.id)}\n            onDragEnd={(e) => {\n              handleElementUpdate(element.id, {\n                x: e.target.x(),\n                y: e.target.y(),\n              });\n            }}\n          />\n        );\n      case \"icon\":\n        return (\n          <Group\n            key={element.id}\n            id={element.id}\n            x={element.x}\n            y={element.y}\n            draggable={element.draggable}\n            onClick={() => setSelectedId(element.id)}\n            onTap={() => setSelectedId(element.id)}\n            onDragEnd={(e) => {\n              handleElementUpdate(element.id, {\n                x: e.target.x(),\n                y: e.target.y(),\n              });\n            }}\n          >\n            {element.iconType === \"phone\" && (\n              <Rect\n                x={0}\n                y={0}\n                width={element.size}\n                height={element.size * 1.6}\n                fill={element.fill}\n              />\n            )}\n            {element.iconType === \"email\" && (\n              <Rect\n                x={0}\n                y={0}\n                width={element.size}\n                height={element.size * 0.8}\n                fill={element.fill}\n              />\n            )}\n            {element.iconType === \"website\" && (\n              <Circle\n                x={element.size / 2}\n                y={element.size / 2}\n                radius={element.size / 2}\n                fill={element.fill}\n              />\n            )}\n          </Group>\n        );\n      default:\n        return null;\n    }\n  };\n\n  if (isLoading) {\n    return (\n      <div className=\"business-card-design\">\n        <div className=\"container\">\n          <div className=\"loading\">読み込み中...</div>\n        </div>\n      </div>\n    );\n  }\n\n  if (!profile) {\n    return (\n      <div className=\"business-card-design\">\n        <div className=\"container\">\n          <div className=\"error\">プロフィールが見つかりません</div>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"business-card-design\">\n      <div className=\"container\">\n        <div className=\"design-header\">\n          <h1>名刺デザイン</h1>\n          <p>名刺の表面・裏面をデザインできます</p>\n        </div>\n\n        <div className=\"design-container\">\n          {/* サイド選択タブ */}\n          <div className=\"side-tabs\">\n            <button\n              className={`side-tab ${currentSide === \"front\" ? \"active\" : \"\"}`}\n              onClick={() => setCurrentSide(\"front\")}\n            >\n              表面\n            </button>\n            <button\n              className={`side-tab ${currentSide === \"back\" ? \"active\" : \"\"}`}\n              onClick={() => setCurrentSide(\"back\")}\n            >\n              裏面\n            </button>\n          </div>\n\n          {/* 描画エリア */}\n          <div className=\"canvas-container\">\n            <div className=\"canvas-wrapper\">\n              <Stage\n                ref={stageRef}\n                width={400}\n                height={242}\n                onMouseDown={(e) => {\n                  if (e.target === e.target.getStage()) {\n                    setSelectedId(null);\n                    setContextMenu({ ...contextMenu, visible: false });\n                  }\n                }}\n              >\n                <Layer>\n                  {/* 背景 */}\n                  <Rect\n                    x={0}\n                    y={0}\n                    width={400}\n                    height={242}\n                    fill=\"#ffffff\"\n                    stroke=\"#e5e7eb\"\n                    strokeWidth={1}\n                  />\n\n                  {/* グリッド */}\n                  {showGrid && (\n                    <>\n                      {Array.from({ length: 20 }, (_, i) => (\n                        <Line\n                          key={`grid-v-${i}`}\n                          x={i * 20}\n                          y={0}\n                          points={[0, 0, 0, 242]}\n                          stroke=\"#f0f0f0\"\n                          strokeWidth={1}\n                        />\n                      ))}\n                      {Array.from({ length: 13 }, (_, i) => (\n                        <Line\n                          key={`grid-h-${i}`}\n                          x={0}\n                          y={i * 20}\n                          points={[0, 0, 400, 0]}\n                          stroke=\"#f0f0f0\"\n                          strokeWidth={1}\n                        />\n                      ))}\n                    </>\n                  )}\n\n                  {/* ガイドライン */}\n                  {showGuidelines && (\n                    <>\n                      <Line\n                        x={200}\n                        y={0}\n                        points={[0, 0, 0, 242]}\n                        stroke=\"#3b82f6\"\n                        strokeWidth={1}\n                        dash={[5, 5]}\n                      />\n                      <Line\n                        x={0}\n                        y={121}\n                        points={[0, 0, 400, 0]}\n                        stroke=\"#3b82f6\"\n                        strokeWidth={1}\n                        dash={[5, 5]}\n                      />\n                    </>\n                  )}\n\n                  {/* デザイン要素 */}\n                  {elements.map(renderElement)}\n\n                  {/* Transformer */}\n                  <Transformer ref={transformerRef} />\n                </Layer>\n              </Stage>\n            </div>\n          </div>\n\n          {/* 下部ツールバー */}\n          <div className=\"bottom-toolbar\">\n            <div className=\"toolbar-scroll\">\n              <div\n                className=\"toolbar-item\"\n                onClick={() => setCurrentTool(\"select\")}\n              >\n                <div className=\"toolbar-icon\">✋</div>\n                <div className=\"toolbar-label\">選択</div>\n              </div>\n              <div\n                className=\"toolbar-item\"\n                onClick={() => handleAddText(\"heading\")}\n              >\n                <div className=\"toolbar-icon\">T</div>\n                <div className=\"toolbar-label\">テキスト</div>\n              </div>\n              <div\n                className=\"toolbar-item\"\n                onClick={() => handleAddShape(\"rect\")}\n              >\n                <div className=\"toolbar-icon\">□</div>\n                <div className=\"toolbar-label\">図形</div>\n              </div>\n              <div\n                className=\"toolbar-item\"\n                onClick={() => handleAddIcon(\"phone\")}\n              >\n                <div className=\"toolbar-icon\">📞</div>\n                <div className=\"toolbar-label\">アイコン</div>\n              </div>\n              <div\n                className={`toolbar-item ${\n                  historyIndex <= 0 ? \"disabled\" : \"\"\n                }`}\n                onClick={historyIndex > 0 ? undo : undefined}\n              >\n                <div className=\"toolbar-icon\">↶</div>\n                <div className=\"toolbar-label\">戻る</div>\n              </div>\n              <div\n                className={`toolbar-item ${\n                  historyIndex >= history.length - 1 ? \"disabled\" : \"\"\n                }`}\n                onClick={historyIndex < history.length - 1 ? redo : undefined}\n              >\n                <div className=\"toolbar-icon\">↷</div>\n                <div className=\"toolbar-label\">進む</div>\n              </div>\n            </div>\n          </div>\n\n          {/* アクションボタン */}\n          <div className=\"design-actions\">\n            <button\n              type=\"button\"\n              className=\"btn btn-secondary\"\n              onClick={handleCancel}\n            >\n              キャンセル\n            </button>\n            <button\n              type=\"button\"\n              className=\"btn btn-primary\"\n              onClick={handleSave}\n            >\n              デザインを保存\n            </button>\n          </div>\n        </div>\n      </div>\n\n      {/* テキスト編集モーダル */}\n      {showTextModal && (\n        <div className=\"modal-overlay\" onClick={() => setShowTextModal(false)}>\n          <div className=\"modal-content\" onClick={(e) => e.stopPropagation()}>\n            <div className=\"modal-header\">\n              <h3>テキスト編集</h3>\n              <button\n                className=\"modal-close\"\n                onClick={() => setShowTextModal(false)}\n              >\n                ×\n              </button>\n            </div>\n\n            <div className=\"modal-body\">\n              <div className=\"search-section\">\n                <div className=\"search-bar\">\n                  <span className=\"search-icon\">🔍</span>\n                  <input\n                    type=\"text\"\n                    placeholder=\"フォントと組み合わせを検索\"\n                    className=\"search-input\"\n                  />\n                </div>\n              </div>\n\n              <div className=\"text-options\">\n                <button\n                  className=\"text-option-btn primary\"\n                  onClick={() => handleAddText(\"heading\")}\n                >\n                  <span className=\"text-icon\">T</span>\n                  <span className=\"text-label\">見出しを追加</span>\n                </button>\n\n                <button\n                  className=\"text-option-btn secondary\"\n                  onClick={() => handleAddText(\"subheading\")}\n                >\n                  <span className=\"text-icon\">T</span>\n                  <span className=\"text-label\">小見出しを追加</span>\n                </button>\n\n                <button\n                  className=\"text-option-btn secondary\"\n                  onClick={() => handleAddText(\"body\")}\n                >\n                  <span className=\"text-icon\">T</span>\n                  <span className=\"text-label\">本文を追加</span>\n                </button>\n              </div>\n\n              {selectedId && (\n                <div className=\"text-editor-section\">\n                  <h4>テキスト編集</h4>\n                  <input\n                    type=\"text\"\n                    value={editingText}\n                    onChange={(e) => setEditingText(e.target.value)}\n                    onBlur={() => handleTextEdit(selectedId, editingText)}\n                    onKeyPress={(e) => {\n                      if (e.key === \"Enter\") {\n                        handleTextEdit(selectedId, editingText);\n                      }\n                    }}\n                    placeholder=\"テキストを入力\"\n                    className=\"text-input\"\n                  />\n\n                  <div className=\"style-controls\">\n                    <label>\n                      フォントサイズ:\n                      <input\n                        type=\"range\"\n                        min=\"8\"\n                        max=\"48\"\n                        value={fontSize}\n                        onChange={(e) => {\n                          setFontSize(Number(e.target.value));\n                          if (selectedId) {\n                            const element = elements.find(\n                              (el) => el.id === selectedId\n                            );\n                            if (element && element.type === \"text\") {\n                              handleElementUpdate(selectedId, {\n                                fontSize: Number(e.target.value),\n                              });\n                            }\n                          }\n                        }}\n                        className=\"font-size-slider\"\n                      />\n                      <span>{fontSize}px</span>\n                    </label>\n\n                    <label>\n                      フォント:\n                      <select\n                        value={fontFamily}\n                        onChange={(e) => {\n                          setFontFamily(e.target.value);\n                          if (selectedId) {\n                            const element = elements.find(\n                              (el) => el.id === selectedId\n                            );\n                            if (element && element.type === \"text\") {\n                              handleElementUpdate(selectedId, {\n                                fontFamily: e.target.value,\n                              });\n                            }\n                          }\n                        }}\n                        className=\"font-family-select\"\n                      >\n                        <option value=\"Arial\">Arial</option>\n                        <option value=\"Helvetica\">Helvetica</option>\n                        <option value=\"Times New Roman\">Times New Roman</option>\n                        <option value=\"Georgia\">Georgia</option>\n                        <option value=\"Verdana\">Verdana</option>\n                      </select>\n                    </label>\n\n                    <label>\n                      色:\n                      <input\n                        type=\"color\"\n                        value={textColor}\n                        onChange={(e) => {\n                          setTextColor(e.target.value);\n                          if (selectedId) {\n                            handleElementUpdate(selectedId, {\n                              fill: e.target.value,\n                            });\n                          }\n                        }}\n                        className=\"color-picker\"\n                      />\n                    </label>\n                  </div>\n                </div>\n              )}\n            </div>\n          </div>\n        </div>\n      )}\n\n      {/* コンテキストメニュー */}\n      {contextMenu.visible && (\n        <div\n          className=\"context-menu\"\n          style={{\n            position: \"absolute\",\n            left: contextMenu.x,\n            top: contextMenu.y,\n            zIndex: 1000,\n          }}\n        >\n          <button\n            className=\"context-menu-btn edit-btn\"\n            onClick={() => {\n              const element = elements.find(\n                (el) => el.id === contextMenu.elementId\n              );\n              if (element && element.type === \"text\") {\n                setEditingText(element.text);\n                setSelectedTextStyle(element.textStyle || \"body\");\n                setShowTextModal(true);\n              }\n              setContextMenu({ ...contextMenu, visible: false });\n            }}\n          >\n            ✏️\n          </button>\n          <button\n            className=\"context-menu-btn delete-btn\"\n            onClick={() => {\n              const newElements = elements.filter(\n                (el) => el.id !== contextMenu.elementId\n              );\n              setElements(newElements);\n              addToHistory(newElements);\n              setSelectedId(null);\n              setContextMenu({ ...contextMenu, visible: false });\n            }}\n          >\n            ⋯\n          </button>\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport default BusinessCardDesign;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}